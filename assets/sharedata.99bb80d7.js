import{d as y,g as p,S as L}from"./util.cc44b56e.js";/* empty css             *//* empty css                */const h={};for(let e=0;e<y.length;e++){const c=y[e][0];let l=Math.round(parseFloat(y[e][1])),t=p(l);h[c.toLowerCase()]=t}async function S(){const e=new URLSearchParams(window.location.search);if(!e.has("userid"))return;const c=e.get("userid"),l=await(await fetch(`${L}user-data`,{method:"POST",body:JSON.stringify({user_id:c})})).json();document.querySelector("#user-id").innerText=c,document.querySelector("#results-container").style.display="block",document.querySelector("#loading").style.display="none",T(l),document.querySelector("#download-data-btn").onclick=()=>{const o=R(l),r=new Blob([o],{type:"text/csv"}),n=window.URL.createObjectURL(r),s=document.createElement("a");s.setAttribute("href",n),s.setAttribute("download","shape-of-america-user-data.csv"),s.click(),window.URL.revokeObjectURL(n)};const t=document.querySelector("#results-table-container");t.querySelectorAll("th").forEach(o=>o.addEventListener("click",r=>{window.column_toggled==null&&(window.column_toggled={});const n=Number(r.target.dataset.index);window.column_toggled[n]=!window.column_toggled[n],$(n,t,window.column_toggled[n])}))}S();function T(e){const c=e.filter(a=>a.correct).length,l=Math.round(c/e.length*100),t=document.querySelector("#results-table");for(let a=0;a<e.length;a++){const d=e[a],m=document.createElement("tr"),{job_title:i,guess:w}=d,u=h[i],g=u==w?"\u2705":"\u274C";d.answer=u;let f="blue";u=="republican"?f="red":u=="mixed"&&(f="mixed"),m.innerHTML=`<td>${g}${i}</td>
        <td>${w}</td>
        <td class=${f}>${u}</td>`,t.appendChild(m)}const o=b(e,"democrat"),r=b(e,"republican"),n=b(e,"mixed"),s=document.querySelector("#results-summary");s.innerHTML=`Accuracy: ${l}%: (${c} / ${e.length}) correct.
    <ul>
      <li>Democrat: (${o.correct}/${o.total}) correct</li>
      <li>Republican: (${r.correct}/${r.total}) correct</li>
      <li>Mixed: (${n.correct}/${n.total}) correct</li>
    </ul>
    `}function b(e,c){const l=e.filter(o=>o.answer==c),t=l.filter(o=>o.correct).length;return{total:l.length,correct:t}}function $(e,c,l=!0){let t,o,r,n,s,a;for(o=!0;o;){for(o=!1,t=c.rows,r=1;r<t.length-1;r++){if(a=!1,n=t[r].getElementsByTagName("td")[e],s=t[r+1].getElementsByTagName("td")[e],!l){let w=n;n=s,s=w}let d=n.innerHTML.toLowerCase()>s.innerHTML.toLowerCase(),m=parseInt(n.innerHTML.toLowerCase())>parseInt(s.innerHTML.toLowerCase()),i=d;if(parseInt(n.innerHTML)&&(i=m),i){a=!0;break}}a&&(t[r].parentNode.insertBefore(t[r+1],t[r]),o=!0)}}function R(e){const c=Object.keys(e[0]),l=[c.join(",")];return e.forEach(t=>{const o=c.map(r=>`"${t[r]}"`);l.push(o.join(","))}),l.join(`
`)}
