import{d as b,S as x,g as M}from"./util.cc44b56e.js";/* empty css             *//* empty css                */const S={};for(let e=0;e<b.length;e++){const o=b[e][0];let t=Math.round(parseFloat(b[e][1])),n=M(t);S[o]=n}document.querySelector("#clear-btn").onclick=()=>{confirm("Delete local data? (server data is retained in the public dataset)")&&(localStorage.clear(),window.location.href="/")};const f=document.querySelector("#copy-btn");f.onclick=()=>{navigator.clipboard.writeText(document.querySelector("#permalink-results").innerHTML),f.innerHTML="\u2705 Copied",window.timeoutid&&(clearTimeout(window.timeoutid),delete window.timeoutid),window.timeoutid=setTimeout(()=>{f.innerHTML="Copy"},1e3)};function p(e,o){const t=e.guesses.filter(r=>r.answer==o),n=t.filter(r=>r.correct).length;return{total:t.length,correct:n}}if(localStorage.getItem("user_id")){let e=window.location.href;e=e.substring(0,e.lastIndexOf("/"));const o=localStorage.getItem("user_id");document.querySelector("#permalink-results").innerHTML=`${e}/sharedata.html?userid=${o}`}const h=document.querySelector("#results-summary");if(localStorage.getItem("results")){const e=JSON.parse(localStorage.getItem("results")),o=e.guesses,t=e.guesses.filter(c=>c.correct).length,n=Math.round(t/o.length*100),r=document.querySelector("#results-table");for(let c=0;c<o.length;c++){const i=o[c],d=document.createElement("tr"),{job_title:u,guess:w}=i,m=S[u],_=m==w?"\u2705":"\u274C";i.answer=m;let g="blue";m=="republican"?g="red":m=="mixed"&&(g="mixed"),d.innerHTML=`<td>${_}${u}</td>
        <td>${w}</td>
        <td class=${g}>${m}</td>`,r.appendChild(d)}const l=p(e,"democrat"),s=p(e,"republican"),a=p(e,"mixed");h.innerHTML=`Accuracy: ${n}%. Total answered: ${o.length}. Correct: ${t}
    <ul>
      <li>Democrat: (${l.correct}/${l.total}) correct</li>
      <li>Republican: (${s.correct}/${s.total}) correct</li>
      <li>Mixed: (${a.correct}/${a.total}) correct</li>
    </ul>
    `,document.querySelector("#download-data-btn").onclick=()=>{const c=$(o),i=new Blob([c],{type:"text/csv"}),d=window.URL.createObjectURL(i),u=document.createElement("a");u.setAttribute("href",d),u.setAttribute("download","shape-of-america-user-data.csv"),u.click(),window.URL.revokeObjectURL(d)}}else h.textContent="No results found!";async function R(){const e=await(await fetch(`${x}global-tally`)).json(),o=document.querySelector("#global-results-table");for(let t of e){const{job_title:n,democrat:r,republican:l,mixed:s,answer:a}=t;let c=r;a=="republican"&&(c=l),a=="mixed"&&(c=s);let i=c/(r+l+s);i=Math.round(i*100);const d=document.createElement("tr");d.innerHTML=`<td>${n}</br><span class="small-text">(${a})</span></td>
        <td>${i}%</td>
        <td>${r}</td>
        <td>${l}</td>
        <td>${s}</td>`,o.appendChild(d)}document.querySelector("#download-global-data-btn").onclick=()=>{const t=$(e),n=new Blob([t],{type:"text/csv"}),r=window.URL.createObjectURL(n),l=document.createElement("a");l.setAttribute("href",r),l.setAttribute("download","shape-of-america-global-data.csv"),l.click(),window.URL.revokeObjectURL(r)}}R();function T(e,o,t=!0){let n,r,l,s,a,c;for(r=!0;r;){for(r=!1,n=o.rows,l=1;l<n.length-1;l++){if(c=!1,s=n[l].getElementsByTagName("td")[e],a=n[l+1].getElementsByTagName("td")[e],!t){let w=s;s=a,a=w}let i=s.innerHTML.toLowerCase()>a.innerHTML.toLowerCase(),d=parseInt(s.innerHTML.toLowerCase())>parseInt(a.innerHTML.toLowerCase()),u=i;if(parseInt(s.innerHTML)&&(u=d),u){c=!0;break}}c&&(n[l].parentNode.insertBefore(n[l+1],n[l]),r=!0)}}const y=document.querySelector("#results-table-container");y.querySelectorAll("th").forEach(e=>e.addEventListener("click",o=>{window.column_toggled==null&&(window.column_toggled={});const t=Number(o.target.dataset.index);window.column_toggled[t]=!window.column_toggled[t],T(t,y,window.column_toggled[t])}));const L=document.querySelector("#global-results-table-container");L.querySelectorAll("th").forEach(e=>e.addEventListener("click",o=>{window.column_toggled_global==null&&(window.column_toggled_global={});const t=Number(o.target.dataset.index);window.column_toggled_global[t]=!window.column_toggled_global[t],T(t,L,window.column_toggled_global[t])}));function $(e){const o=Object.keys(e[0]),t=[o.join(",")];return e.forEach(n=>{const r=o.map(l=>`"${n[l]}"`);t.push(r.join(","))}),t.join(`
`)}
