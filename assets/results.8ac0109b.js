import{d as b,S as T,g as R}from"./util.aa084a86.js";/* empty css             */const L={};for(let e=0;e<b.length;e++){const l=b[e][0];let t=Math.round(parseFloat(b[e][1])),n=R(t);L[l]=n}document.querySelector("#clear-btn").onclick=()=>{confirm("Delete local data? (server data is retained in the public dataset)")&&(localStorage.clear(),window.location.href="/")};function f(e,l){const t=e.guesses.filter(r=>r.answer==l),n=t.filter(r=>r.correct).length;return{total:t.length,correct:n}}const h=document.querySelector("#results-summary");if(localStorage.getItem("results")){const e=JSON.parse(localStorage.getItem("results")),l=e.guesses,t=e.guesses.filter(c=>c.correct).length,n=Math.round(t/l.length*100),r=document.querySelector("#results-table");for(let c=0;c<l.length;c++){const i=l[c],d=document.createElement("tr"),{job_title:u,guess:g}=i,m=L[u],S=m==g?"\u2705":"\u274C";i.answer=m;let w="blue";m=="republican"?w="red":m=="mixed"&&(w="mixed"),d.innerHTML=`<td>${S}${u}</td>
        <td>${g}</td>
        <td class=${w}>${m}</td>`,r.appendChild(d)}const o=f(e,"democrat"),s=f(e,"republican"),a=f(e,"mixed");h.innerHTML=`Accuracy: ${n}%. Total answered: ${l.length}. Correct: ${t}
    <ul>
      <li>Democrat: (${o.correct}/${o.total}) correct</li>
      <li>Republican: (${s.correct}/${s.total}) correct</li>
      <li>Mixed: (${a.correct}/${a.total}) correct</li>
    </ul>
    `,document.querySelector("#download-data-btn").onclick=()=>{const c=$(l),i=new Blob([c],{type:"text/csv"}),d=window.URL.createObjectURL(i),u=document.createElement("a");u.setAttribute("href",d),u.setAttribute("download","shape-of-america-user-data.csv"),u.click(),window.URL.revokeObjectURL(d)}}else h.textContent="No results found!";async function v(){const e=await(await fetch(`${T}global-tally`)).json(),l=document.querySelector("#global-results-table");for(let t of e){const{job_title:n,democrat:r,republican:o,mixed:s,answer:a}=t;let c=r;a=="republican"&&(c=o),a=="mixed"&&(c=s);let i=c/(r+o+s);i=Math.round(i*100);const d=document.createElement("tr");d.innerHTML=`<td>${n}</td>
        <td>${r}</td>
        <td>${o}</td>
        <td>${s}</td>
        <td>${i}%</td>`,l.appendChild(d)}document.querySelector("#download-global-data-btn").onclick=()=>{const t=$(e),n=new Blob([t],{type:"text/csv"}),r=window.URL.createObjectURL(n),o=document.createElement("a");o.setAttribute("href",r),o.setAttribute("download","shape-of-america-global-data.csv"),o.click(),window.URL.revokeObjectURL(r)}}v();function _(e,l,t=!0){let n,r,o,s,a,c;for(r=!0;r;){for(r=!1,n=l.rows,o=1;o<n.length-1;o++){if(c=!1,s=n[o].getElementsByTagName("td")[e],a=n[o+1].getElementsByTagName("td")[e],!t){let g=s;s=a,a=g}let i=s.innerHTML.toLowerCase()>a.innerHTML.toLowerCase(),d=parseInt(s.innerHTML.toLowerCase())>parseInt(a.innerHTML.toLowerCase()),u=i;if(parseInt(s.innerHTML)&&(u=d),u){c=!0;break}}c&&(n[o].parentNode.insertBefore(n[o+1],n[o]),r=!0)}}const p=document.querySelector("#results-table-container");p.querySelectorAll("th").forEach(e=>e.addEventListener("click",l=>{window.column_toggled==null&&(window.column_toggled={});const t=Number(l.target.dataset.index);window.column_toggled[t]=!window.column_toggled[t],_(t,p,window.column_toggled[t])}));const y=document.querySelector("#global-results-table-container");y.querySelectorAll("th").forEach(e=>e.addEventListener("click",l=>{window.column_toggled_global==null&&(window.column_toggled_global={});const t=Number(l.target.dataset.index);window.column_toggled_global[t]=!window.column_toggled_global[t],_(t,y,window.column_toggled_global[t])}));function $(e){const l=Object.keys(e[0]),t=[l.join(",")];return e.forEach(n=>{const r=l.map(o=>`"${n[o]}"`);t.push(r.join(","))}),t.join(`
`)}
